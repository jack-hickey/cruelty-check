const productsGetter=Ajax.Get("products.json"),resultsContainer=document.getElementById("ctResults");function search(){const t=txtSearch.value.trim();t&&Promise.resolve(productsGetter).then(e=>{(e=e.body).forEach(t=>{t._search=`${t.brand} ${t.name}`}),displayResults(SearchArray(e,t,"_search"))})}function displayResults(t){if(resultsContainer.innerHTML="",txtResultCount.innerHTML="",t.length)resultsContainer.addItems(t.map(t=>buildResult(t))),txtResultCount.innerHTML=`<span class="fw-bold">${t.length}</span> product${1===t.length?"":"s"} found`;else{resultsContainer.appendChild(document.createElementWithContents("chip-emptyprompt",'Nothing could be found matching \'<span id="lblSearchTerm" class="fw-bold"></span>\'. If you\'d like, you can <chip-button variation="info-tertiary" id="btnReportMissing" button-style="inline">report the product missing</chip-button> to improve the chances of it being included.',{heading:Localizer.EMPTY_SEARCH_TITLE,icon:"fal fa-store-slash",className:"mt-form--lg"}));const t=txtSearch.value;lblSearchTerm.textContent=t,btnReportMissing.onclick=()=>Dialog.ShowTextBox(Localizer.MISSING_PRODUCT_TITLE,Localizer.MISSING_PRODUCT_DESC,{DefaultValue:t}).then(t=>autoReportMissing(t))}}function autoReportMissing(t){report("MISSING-PRODUCT","Missing Product Report",`Using the built in feedback feature, a user has reported the following product as missing:\n>${t}`)}function report(t,e,i){Ajax.Post("report",{body:{type:t,title:e,description:i},success:{ok:t=>{Dialog.ShowSuccess(Localizer.FEEDBACK_SUCCESS_TITLE,Localizer.FEEDBACK_SUCCESS_DESC)}}})}function buildResult(t){const e=document.createElementWithContents("chip-card",`\n\t\t\t<div class="h-align mt-card">\n\t\t\t\t<chip-text class="me-auto" variation="secondary">${t.brand}</chip-text>\n\t\t\t\t<chip-button\n\t\t\t\t\tflush\n\t\t\t\t\tclass="btn--report-product"\n\t\t\t\t\tbutton-style="icon"\n\t\t\t\t\ttooltip="${Localizer.REPORT_INCORRECT_BUTTON}"\n\t\t\t\t\ticon="fas fa-flag"\n\t\t\t\t\tvariation="danger-tertiary">\n\t\t\t\t</chip-button>\n\t\t\t</div>\n\t\t\t<chip-text class="mb-form" weight="medium" size="h4">${t.name}</chip-text>\n\n\t\t\t<chip-list gap="sm">\n\t\t\t\t<chip-listitem>\n\t\t\t\t\t${t.vegan?`<chip-text icon-colour="success" icon="fas fa-check-circle">${Localizer.VEGAN_LABEL}</chip-text>`:`<chip-text icon-colour="danger" icon="fas fa-times-circle">${Localizer.NOT_VEGAN_LABEL}</chip-text>`}\n\t\t\t\t</chip-listitem>\n\t\t\t\t<chip-listitem>\n\t\t\t\t\t${t.cruelty_free?`<chip-text icon-colour="success" icon="fas fa-check-circle">${Localizer.CRUELTYFREE_LABEL}</chip-text>`:`<chip-text icon-colour="danger" icon="fas fa-times-circle">${Localizer.NOT_CRUELTYFREE_LABEL}</chip-text>`}\n\t\t\t\t</chip-listitem>\n\t\t\t\t<chip-listitem>\n\t\t\t\t\t${t.parent?`<chip-text icon-colour="success" icon="fas fa-check-circle">${Localizer.PARENT_CRUELTYFREE_LABEL}</chip-text>`:`<chip-text icon-colour="danger" icon="fas fa-times-circle">${Localizer.PARENT_NOT_CRUELTYFREE_LABEL}</chip-text>`}\n\t\t\t\t</chip-listitem>\n\t\t\t</chip-list>\n\n\t\t\t${t.info?`<chip-accordionitem class="mt-form ai--view-info" heading="${Localizer.VIEW_INFO_LABEL}">${t.info}</chip-accordionitem>`:""}\n\t\t`,{image:`images/products/${t.image}`,hideBlur:!0});return e.querySelector(".btn--report-product").onclick=()=>{Dialog.ShowTextBox(Localizer.INCORRECT_INFORMATION_TITLE,Localizer.INCORRECT_INFORMATION_DESC,{Rows:12,Multiline:!0}).then(e=>{report("INCORRECT-INFO","Incorrect Product Information",`Using the built in feedback feature, a user has reported that **${t.name}** by **${t.brand}** has incorrect information, stating:\n>${e}`)})},e}btnFeedback.onclick=()=>Dialog.ShowCustom(Localizer.FEEDBACK_TITLE,Localizer.FEEDBACK_DESC,`\n\t\t<chip-form>\n\t\t\t<chip-dropdown\n\t\t\t\tlabel="${Localizer.FEEDBACK_TYPE_LABEL}"\n\t\t\t\trequired\n\t\t\t\tid="drpType"\n\t\t\t\ttext="${Localizer.FEEDBACK_TYPE_PLACEHOLDER}">\n\n\t\t\t\t<chip-dropdownitem group="${Localizer.FEEDBACK_BUG_GROUP}" value="BUG">${Localizer.FEEDBACK_BUG_LABEL}</chip-dropdownitem>\n\t\t\t\t<chip-dropdownitem group="${Localizer.FEEDBACK_BUG_GROUP}" value="MISSING-PRODUCT">${Localizer.FEEDBACK_MISSING_PRODUCT_LABEL}</chip-dropdownitem>\n\t\t\t\t<chip-dropdownitem group="${Localizer.FEEDBACK_BUG_GROUP}" value="INCORRECT-INFO">${Localizer.FEEDBACK_INCORRECT_INFORMATION_LABEL}</chip-dropdownitem>\n\t\t\t\t<chip-dropdownitem group="${Localizer.FEEDBACK_IMPROVEMENT_GROUP}" value="FEATURE">${Localizer.FEEDBACK_FEATURE_LABEL}</chip-dropdownitem>\n\t\t\t\t<chip-dropdownitem group="${Localizer.FEEDBACK_IMPROVEMENT_GROUP}" value="IMPROVEMENT">${Localizer.FEEDBACK_IMPROVEMENT_LABEL}</chip-dropdownitem>\n\t\t\t\t<chip-dropdownitem group="${Localizer.FEEDBACK_CHAT_GROUP}" value="THANKS">${Localizer.FEEDBACK_THANKS_LABEL}</chip-dropdownitem>\n\t\t\t</chip-dropdown>\n\n\t\t\t<chip-textarea\n\t\t\t\trows="12"\n\t\t\t\trequired\n\t\t\t\tid="txtDetails"\n\t\t\t\tvalidation-required="${Localizer.FEEDBACK_DETAILS_VALIDATION_REQUIRED}"\n\t\t\t\tclass="mt-form"\n\t\t\t\tlabel="${Localizer.FEEDBACK_DETAILS_LABEL}">\n\t\t\t</chip-textarea>\n\t\t</chip-form>\n\t`,{NegativeText:"",Theme:"FORM",Size:"md",OnCheckValid:t=>t.querySelector("chip-form").reportValidity(),AffirmativeText:"Submit"}).then(()=>report(drpType.value,"User Submitted Feedback",txtDetails.value)),txtSearch.onkeyup=t=>{"Enter"===t.key&&search()};