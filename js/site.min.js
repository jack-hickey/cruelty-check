const productsGetter=Ajax.Get("products.json"),resultsContainer=document.getElementById("ctResults");function search(){const t=txtSearch.value.trim();t&&Promise.resolve(productsGetter).then(e=>{(e=e.body).forEach(t=>{t._search=`${t.brand} ${t.name}`}),displayResults(SearchArray(e,t,"_search"))})}function displayResults(t){resultsContainer.innerHTML="",t.length?resultsContainer.addItems(t.map(t=>buildResult(t))):(resultsContainer.appendChild(document.createElementWithContents("chip-emptyprompt",'Hmmm, we couldn\'t find anything matching \'<span id="lblSearchTerm" class="fw-bold"></span>\'. If you\'d like, you can <chip-button variation="info-tertiary" id="btnReportMissing" button-style="inline">report the product missing</chip-button> and we\'ll do our best to get it in!',{heading:"Nothing to see here",icon:"fal fa-store-slash",className:"mt-form--lg"})),lblSearchTerm.textContent=txtSearch.value,btnReportMissing.onclick=()=>Dialog.ShowConfirmation(Localizer.CONFIRMATION_TITLE,`Are you sure you'd like to report a missing product? Your search of '${txtSearch.value}' will be used in the report.`).then(t=>{t&&autoReportMissing()}))}function autoReportMissing(){report("MISSING-PRODUCT","Missing Product Report",`The following search term was made by a user and couldn't be matched with any products:\n>${txtSearch.value}`)}function report(t,e,i){Ajax.Post("report",{body:{type:t,title:e,description:i},success:{ok:t=>{Dialog.ShowSuccess("Feedback sent","Thank you for your feedback! We really appreciate you helping us to improve.")}}})}function buildResult(t){let e="danger";(t.vegan||t.cruelty_free)&&(e="warning"),t.vegan&&t.cruelty_free&&(e="success");const i=document.createElementWithContents("chip-card",`\n\t\t\t<chip-text class="mt-card mb-xs" variation="secondary">${t.brand}</chip-text>\n\t\t\t<chip-text class="mb-form" weight="medium" size="h4">${t.name}</chip-text>\n\n\t\t\t<chip-list gap="sm">\n\t\t\t\t<chip-listitem>\n\t\t\t\t\t${t.vegan?'<chip-text icon-colour="success" icon="fas fa-check-circle">Vegan</chip-text>':'<chip-text icon-colour="danger" icon="fas fa-times-circle">Not vegan</chip-text>'}\n\t\t\t\t</chip-listitem>\n\t\t\t\t<chip-listitem>\n\t\t\t\t\t${t.cruelty_free?'<chip-text icon-colour="success" icon="fas fa-check-circle">Cruelty-free</chip-text>':'<chip-text icon-colour="danger" icon="fas fa-times-circle">Not cruelty-free</chip-text>'}\n\t\t\t\t</chip-listitem>\n\t\t\t</chip-list>\n\n\t\t\t${t.info?`<chip-accordionitem class="mt-form ai--view-info" heading="View info">${t.info}</chip-accordionitem>`:""}\n\t\t`,{image:`images/products/${t.image}`,hideBlur:!0});return i.dataset.theme=e,i}btnFeedback.onclick=()=>Dialog.ShowCustom("Feedback","Your feedback is valuable, you can report any issues you've run into or anything you'd like to see on the site!",'\n\t\t<chip-form>\n\t\t\t<chip-dropdown\n\t\t\t\tlabel="Feedback type"\n\t\t\t\trequired\n\t\t\t\tid="drpType"\n\t\t\t\tvalidation-required="Please choose the kind of feedback you\'d like to share."\n\t\t\t\ttext="Choose an option">\n\n\t\t\t\t<chip-dropdownitem group="Having a problem?" value="BUG">Something\'s not working</chip-dropdownitem>\n\t\t\t\t<chip-dropdownitem group="Having a problem?" value="MISSING-PRODUCT">I couldn\'t find a product</chip-dropdownitem>\n\t\t\t\t<chip-dropdownitem group="Having a problem?" value="INCORRECT-INFO">Product info is wrong</chip-dropdownitem>\n\t\t\t\t<chip-dropdownitem group="Got an idea?" value="FEATURE">I\'ve got an idea</chip-dropdownitem>\n\t\t\t\t<chip-dropdownitem group="Got an idea?" value="IMPROVEMENT">Suggestion for improvement</chip-dropdownitem>\n\t\t\t\t<chip-dropdownitem group="Just want to say something" value="THANKS">Just saying thanks!</chip-dropdownitem>\n\t\t\t</chip-dropdown>\n\n\t\t\t<chip-textarea\n\t\t\t\trows="12"\n\t\t\t\trequired\n\t\t\t\tid="txtDetails"\n\t\t\t\tvalidation-required="Please tell us a bit more so we understand your feedback"\n\t\t\t\tclass="mt-form"\n\t\t\t\tlabel="Tell us more">\n\t\t\t</chip-textarea>\n\t\t</chip-form>\n\t',{NegativeText:"",Theme:"FORM",Size:"md",OnCheckValid:t=>t.querySelector("chip-form").reportValidity(),AffirmativeText:"Submit"}).then(()=>report(drpType.value,"User Submitted Feedback",txtDetails.value)),txtSearch.onkeyup=t=>{"Enter"===t.key&&search()};