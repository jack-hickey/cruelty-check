export async function onRequest(e){if("POST"!==e.request.method)return new Response("Method Not Allowed",{status:405});let t=await e.request.json(),s="Unknown",i="Unknown",n=e.request.headers.get("user-agent").toLowerCase();if(!n.includes("chrome")||n.includes("edge")||n.includes("opr")?n.includes("firefox")?s="Firefox":n.includes("safari")&&!n.includes("chrome")?s="Safari":n.includes("edge")?s="Edge":(n.includes("opr")||n.includes("opera"))&&(s="Opera"):s="Chrome",/Windows NT 10\.0/i.test(n)?i="Windows 10/11":/Windows NT 6\.3/i.test(n)?i="Windows 8.1":/Windows NT 6\.2/i.test(n)?i="Windows 8":/Windows NT 6\.1/i.test(n)?i="Windows 7":/Windows Phone|IEMobile/i.test(n)?i="Windows Phone":/Macintosh|Mac OS X/i.test(n)?i="macOS":/CrOS/i.test(n)?i="ChromeOS":/Linux/i.test(n)?i="Linux":/Android/i.test(n)?i="Android":/iPhone|iPad|iPod/i.test(n)&&(i="iOS"),!t.title||!t.description||!t.type)return new Response("Bad Request",{status:400});const o=`### Browser\n${s}\n### Operating System\n${i}\n### Details\n${t.description}`,d=await fetch(`https://api.github.com/repos/${e.env.GITHUB_REPO}/issues`,{method:"POST",headers:{Authorization:`token ${e.env.GITHUB_TOKEN}`,Accept:"application/vnd.github+json","User-Agent":"cloudflare-pages-form"},body:JSON.stringify({title:t.title,body:o,labels:[t.type.toLowerCase()],assignee:"jack-hickey"})});return d.ok?new Response("",{status:200}):new Response(await d.text(),{status:d.status})}